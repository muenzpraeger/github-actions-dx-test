"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/*
 * Copyright (c) 2018, salesforce.com, inc.
 * All rights reserved.
 * SPDX-License-Identifier: MIT
 * For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/MIT
 */
const language_1 = require("../shared/language");
const element_1 = require("../env/element");
const ShadowTokenPrivateKey = '$$ShadowTokenKey$$';
function getShadowToken(node) {
    return node.$shadowToken$;
}
exports.getShadowToken = getShadowToken;
function setShadowToken(node, shadowToken) {
    node.$shadowToken$ = shadowToken;
}
exports.setShadowToken = setShadowToken;
/**
 * Patching Element.prototype.$shadowToken$ to mark elements a portal:
 *
 *  - we use a property to allow engines to set a custom attribute that should be
 *    placed into the element to sandbox the css rules defined for the template.
 *
 *  - this custom attribute must be unique.
 *
 **/
language_1.defineProperty(Element.prototype, '$shadowToken$', {
    set(shadowToken) {
        const oldShadowToken = this[ShadowTokenPrivateKey];
        if (!language_1.isUndefined(oldShadowToken) && oldShadowToken !== shadowToken) {
            element_1.removeAttribute.call(this, oldShadowToken);
        }
        if (!language_1.isUndefined(shadowToken)) {
            element_1.setAttribute.call(this, shadowToken, '');
        }
        this[ShadowTokenPrivateKey] = shadowToken;
    },
    get() {
        return this[ShadowTokenPrivateKey];
    },
    configurable: true,
});
//# sourceMappingURL=shadow-token.js.map